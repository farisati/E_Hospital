{% extends "doctor/doctor_base.html" %}
{% block content %}

<div class="container-fluid mt-4">

  <!-- Page Header -->
  <div class="d-flex justify-content-between align-items-center mb-4">
    <div>
      <h3 class="fw-bold text-dark mb-0">My Appointments</h3>
      <small class="text-muted">Manage your daily, upcoming and completed consultations</small>
    </div>
  </div>

  <!-- ================= TODAY ================= -->
  <div class="card shadow-sm border-0 mb-4">
    <div class="card-header bg-success text-white fw-semibold">
      <i class="bi bi-calendar-check me-2"></i> Todayâ€™s Appointments
    </div>

    <div class="card-body p-0">
      {% if today_appointments %}
      <div class="table-responsive">
        <table class="table table-hover align-middle mb-0">
          <thead class="table-light">
            <tr>
              <th>Time</th>
              <th>Patient</th>
              <th>Reason</th>
              <th class="text-end">Action</th>
            </tr>
          </thead>
          <tbody>
            {% for appt in today_appointments %}
            <tr>
              <td class="fw-semibold">{{ appt.time }}</td>
              <td>{{ appt.patient.get_username }}</td>
              <td>{{ appt.reason|default:"-" }}</td>
              <td class="text-end">
                <a href="{% url 'doctor:appointment_detail' appt.id %}"
                   class="btn btn-sm btn-outline-primary">
                  View
                </a>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
      {% else %}
        <div class="p-3 text-muted">No appointments scheduled for today.</div>
      {% endif %}
    </div>
  </div>

  <!-- ================= UPCOMING ================= -->
  <div class="card shadow-sm border-0 mb-4">
    <div class="card-header bg-primary text-white fw-semibold">
      <i class="bi bi-calendar-event me-2"></i> Upcoming Appointments
    </div>

    <div class="card-body p-0">
      {% if upcoming_appointments %}
      <div class="table-responsive">
        <table class="table table-hover align-middle mb-0">
          <thead class="table-light">
            <tr>
              <th>Date</th>
              <th>Time</th>
              <th>Patient</th>
              <th class="text-end">Action</th>
            </tr>
          </thead>
          <tbody>
            {% for appt in upcoming_appointments %}
            <tr>
              <td>{{ appt.date }}</td>
              <td>{{ appt.time }}</td>
              <td>{{ appt.patient.get_username }}</td>
              <td class="text-end">
                <a href="{% url 'doctor:appointment_detail' appt.id %}"
                   class="btn btn-sm btn-outline-info">
                  View
                </a>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
      {% else %}
        <div class="p-3 text-muted">No upcoming appointments.</div>
      {% endif %}
    </div>
  </div>

  <!-- ================= COMPLETED ================= -->
  <div class="card shadow-sm border-0">
    <div class="card-header bg-secondary text-white fw-semibold">
      <i class="bi bi-check-circle me-2"></i> Completed Appointments
    </div>

    <div class="card-body p-0">
      {% if completed_appointments %}
      <div class="table-responsive">
        <table class="table table-hover align-middle mb-0">
          <thead class="table-light">
            <tr>
              <th>Date</th>
              <th>Time</th>
              <th>Patient</th>
              <th>Reason</th>
              <th>Status</th>
            </tr>
          </thead>
          <tbody>
            {% for appt in completed_appointments %}
            <tr>
              <td>{{ appt.date }}</td>
              <td>{{ appt.time }}</td>
              <td>{{ appt.patient.get_username }}</td>
              <td>{{ appt.reason|default:"-" }}</td>
              <td>
                <span class="badge bg-success">Completed</span>
              </td>
              <td class="text-end">
                <a href="{% url 'doctor:appointment_detail' appt.id %}"
                   class="btn btn-sm btn-outline-primary">
                  View
                </a>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
      {% else %}
        <div class="p-3 text-muted">No completed appointments yet.</div>
      {% endif %}
    </div>
  </div>

</div>

{% endblock %}
